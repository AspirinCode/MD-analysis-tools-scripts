* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) VERSION on May, 09. 2015.
* GBSW

DIMENS CHSIZE 2000000
!DIMENS CHSIZE 1000000

! Read topology and parameter files
stream toppar.str.bak

! Read PSF
open read unit 10 card name step1_pdbreader.psf
read psf  unit 10 card xplor

! Read COOR
open read unit 10 card name step1_pdbreader.crd
read coor unit 10 card

!-------------------------------------------------------------
! GBSW related setups: nonbond options and input radii
!-------------------------------------------------------------
! the following nonbond opotions are recommended for GBSW
NBOND atom switch cdie vdw vswitch -
      ctonnb 16.0 ctofnb 16.0 cutnb 20.0

! read in the input radii and check for missing entries
prnlev 0   !stream @toppar/radius.str (suppress long outputs with prnlev 0)
stream toppar/radius_gbsw.str
prnlev 5
scalar wmain statistics select .not. type H* end
!double check radii setup: some heavy atom have a zero radius
define check select (.not type H* ) .and. -
                    ( property wmain .eq. 0.0 ) show end
if ?nsel ne 0  stop  !!!ERROR: some heavy atoms have zero radii.

! here we request GBSW implicit solvent (recommanded options)
gbsw reset
gbsw sgamma 0.005 nang 50


!
! Planar restraints
!

coor stat sele type CA .and. (resid 1495 .or. resid 1672) show end

MMFP
   GEO plane -
       xref 0.0  yref 0.0  zref ?zave  zdir 1.0 -
       harmonic inside force 10.0 droff 2.5 sele type CA .and. (resid 1495 .or. resid 1672) show end
END

ENERGY

!
! Pulling
!

open write unit 99 card name junk.plo,@force

AFM CF ALPHA @force sele type CA .and. (resid 1495 .or. resid 1672) show end IUNJ 99
!             [IUNJ integer] [XIMAX real]

ENERGY

!
! short minimization and Langevin dynamics
! NOTE: CHANGE ISEED EACH TIME FOR RESTART IN LANGEVIN DYNAMICS
!

mini   sd nstep 50 nprint 10 step 0.005 inbfrq -1
mini abnr nstep 50 nprint 10 step 0.005 inbfrq -1

set fbeta = 5.0
set temp  = 310.15

scalar fbeta set @fbeta
scalar fbeta set 0.0    select type H* end

shake bonh param fast

open write unit 12 card name junk.rst,@force
open write unit 13 file name junk.dcd,@force

DYNAMICS LANGEVIN      start          nstep  1000000  timestp 0.002  -
         nprint  1000  iprfrq   5000  isvfrq   5000  ntrfrq    500 -
         inbfrq    -1  imgfrq     -1  ihbfrq      0  ilbfrq      0 -
         firstt @temp  finalt  @temp  iseed 47858436 -
         tbath  @temp  rbuf      0.0  -
         iunread   -1  iunwrite   12  iuncrd     13  iunvelo    -1 -
         nsavcrd 1000  nsavvelo    0  -
         iasvel     1

open write card unit 10 name junk.pdb,@force
write coor pdb  unit 10


stop
